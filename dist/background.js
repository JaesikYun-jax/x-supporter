class g{static async get(r){try{return(await chrome.storage.local.get(r))[r]}catch(e){console.error(`ìŠ¤í† ë¦¬ì§€ì—ì„œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨: ${e}`);return}}static async set(r,e){try{await chrome.storage.local.set({[r]:e})}catch(o){console.error(`ìŠ¤í† ë¦¬ì§€ì— ë°ì´í„° ì €ì¥ ì‹¤íŒ¨: ${o}`)}}static async remove(r){try{await chrome.storage.local.remove(r)}catch(e){console.error(`ìŠ¤í† ë¦¬ì§€ì—ì„œ ë°ì´í„° ì‚­ì œ ì‹¤íŒ¨: ${e}`)}}static onChanged(r){chrome.storage.onChanged.addListener((e,o)=>{o==="local"&&r(e)})}}const S={systemPrompt:`ë‹¹ì‹ ì€ Web3ì™€ ì•”í˜¸í™”í ì—´ì •ê°€ì¸ 'Web3 Degen'ì˜ ì—­í• ë¡œ X.comì—ì„œ íŠ¸ìœ— ì»¨í…ìŠ¤íŠ¸ë¥¼ ê¸°ë°˜í•œ ë‹µë³€ì„ ì‘ì„±í•´ì•¼ í•œë‹¤.
ë‹µë³€ì˜ íŠ¹ì§•ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.

1. 'gm', 'ser', 'fren', 'wen', 'WAGMI', 'NGMI', 'alpha', 'degen', '3 commas'ì™€ ê°™ì€ Web3 ìŠ¬ë­ê³¼ ìš©ì–´ë¥¼ ì‚¬ìš©í•˜ì„¸ìš”.
2. í† í° ê°€ê²©, ì»¤ë®¤ë‹ˆí‹°ì  êµë¥˜ê°€ ì¤‘ì‹¬ì¸ ìƒí™©ì—ì„œ 'ğŸš€', 'ğŸ’ğŸ™Œ', 'lfg', 'bullish'ì™€ ê°™ì€ í‘œí˜„ì„ ì‚¬ìš©í•˜ì„¸ìš”.
3. ëŒ€í™”ë¥¼ ì‹œì‘í•  ë•ŒëŠ” 'gm' ë˜ëŠ” 'gn'ë¡œ ì‹œì‘í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.
4. ì¹œê·¼í•˜ê³  ê²©ì‹ ì—†ëŠ” ë§íˆ¬ë¥¼ ìœ ì§€í•˜ì„¸ìš”.
5. ì²« ê¸€ìë¥¼ ëŒ€ë¬¸ìë¡œ ì‚¬ìš©í•˜ì§€ ë§ˆì„¸ìš”. ëª¨ë‘ ì†Œë¬¸ìë¡œ ì“°ê³  ë¬¸ë²•ì„ ì¼ë¶€ëŸ¬ í‹€ë¦¬ê±°ë‚˜ ì¶•ì•½ì–´ë¥¼ ì ê·¹ì ìœ¼ë¡œ ì‚¬ìš©í•˜ì„¸ìš”.`,userPrompt:`ë‹¤ìŒ íŠ¸ìœ— ìŠ¤ë ˆë“œì— ëŒ€í•œ Web3 ìŠ¤íƒ€ì¼ì˜ ëŒ€ë‹µì„ 3ê°€ì§€ íƒ€ì…ìœ¼ë¡œ ìƒì„±í•´ì£¼ì„¸ìš”:
ì „ì²´ì ì¸ ë§¥ë½ì„ ê³ ë ¤í•˜ë˜ ìµœì¢…ì ìœ¼ë¡œëŠ” ìµœì†Œí•œì˜ ë¬¸ì¥ìœ¼ë¡œ ë‹µë³€í•˜ì„¸ìš”.
{{THREAD_CONTEXT}}

ë‹¤ìŒ í˜•ì‹ìœ¼ë¡œ ì •í™•íˆ 3ê°œì˜ ì‘ë‹µì„ ì œê³µí•´ì£¼ì„¸ìš”:

1/ [ì§§ê³  ì¹œê·¼í•œ ì¸ì‚¬ - Web3 ìŠ¬ë­ ì‚¬ìš©]

2/ [íŠ¸ìœ— ë‚´ìš© ì¼ë¶€ë¥¼ ì¸ìš©í•˜ë©° ë™ì˜í•˜ëŠ” ë‚´ìš©]

3/ [ìê¸° ë¹„í•˜ì ì¸ Web3/ì•”í˜¸í™”í ê´€ë ¨ ë†ë‹´]

ê° ì‘ë‹µì€ ì •í™•íˆ "1/", "2/", "3/"ë¡œ ì‹œì‘í•´ì•¼ í•˜ë©°, ì‘ë‹µ ê°„ì—ëŠ” ë¹ˆ ì¤„ì„ ì¶”ê°€í•´ì£¼ì„¸ìš”.
ì–´ë–¤ ë‚´ìš©ì´ë“  ë°˜ë“œì‹œ ì´ í˜•ì‹ì„ ë”°ë¼ì£¼ì„¸ìš”.`};function C(t){if(!t)return"ëŒ€í™” ì»¨í…ìŠ¤íŠ¸ ì—†ìŒ";let r="";if(t.mainTweet){const e=t.mainTweet;r+=`ë©”ì¸ íŠ¸ìœ— (@${e.author.username}): "${e.text}"

`}if(t.intermediateReplies&&t.intermediateReplies.length>0&&(r+=`ì¤‘ê°„ ë‹µê¸€ë“¤:
`,t.intermediateReplies.forEach((e,o)=>{r+=`${o+1}. @${e.author.username}: "${e.text}"
`}),r+=`
`),t.replyTarget){const e=t.replyTarget;r+=`ë‹µì¥ ëŒ€ìƒ (@${e.author.username}): "${e.text}"`}return r}function P(t){const r=C(t),e=S.userPrompt.replace(/{{THREAD_CONTEXT}}/g,r);return{systemPrompt:S.systemPrompt,userPrompt:e}}const d={isAlive:!0,startTime:Date.now(),pingInterval:null,wakeInterval:null,pendingResponses:new Map,keepAlive(){this.wakeInterval&&(clearInterval(this.wakeInterval),this.wakeInterval=null),this.wakeInterval=setInterval(()=>{this.isAlive=!0;const t=Math.floor((Date.now()-this.startTime)/1e3);console.debug(`ë°±ê·¸ë¼ìš´ë“œ ìŠ¤í¬ë¦½íŠ¸ í™œì„± ìœ ì§€ ì¤‘ (ê°€ë™ ì‹œê°„: ${t}ì´ˆ)`),t>0&&t%1500===0&&s.addLog(`ë°±ê·¸ë¼ìš´ë“œ ìŠ¤í¬ë¦½íŠ¸ ê°€ë™ ì¤‘ (${Math.floor(t/60)}ë¶„)`,"info")},15e3),this.pingInterval&&(clearInterval(this.pingInterval),this.pingInterval=null),this.pingInterval=setInterval(async()=>{try{await this.pingContentScriptTabs()}catch(t){console.debug("íƒ­ í•‘ ì˜¤ë¥˜:",t)}},3e4)},async pingContentScriptTabs(){const t=[...b.contentScriptTabs];for(const r of t)try{await b.isContentScriptActive(r)}catch(e){console.debug(`íƒ­ ${r} í•‘ ì‹¤íŒ¨:`,e)}},registerPendingResponse(t,r){this.pendingResponses.set(t,r),setTimeout(()=>{this.pendingResponses.delete(t)},1e4)},hasPendingResponse(t){return this.pendingResponses.has(t)},executePendingResponse(t,r){if(this.pendingResponses.has(t)){try{this.pendingResponses.get(t)(r)}catch(e){console.error("ì‘ë‹µ ì½œë°± ì‹¤í–‰ ì˜¤ë¥˜:",e)}return this.pendingResponses.delete(t),!0}return!1},cleanup(){this.wakeInterval&&(clearInterval(this.wakeInterval),this.wakeInterval=null),this.pingInterval&&(clearInterval(this.pingInterval),this.pingInterval=null),this.pendingResponses.clear()}},b={active:!0,contentScriptTabs:new Set,registerContentScript(t){this.contentScriptTabs.add(t),console.log(`ì½˜í…ì¸  ìŠ¤í¬ë¦½íŠ¸ ë“±ë¡: íƒ­ ${t}`)},unregisterContentScript(t){this.contentScriptTabs.delete(t),console.log(`ì½˜í…ì¸  ìŠ¤í¬ë¦½íŠ¸ ì—°ê²° í•´ì œ: íƒ­ ${t}`)},async broadcastMessage(t){const r=[...this.contentScriptTabs];for(const e of r)try{await chrome.tabs.sendMessage(e,t)}catch(o){console.warn(`íƒ­ ${e}ì— ë©”ì‹œì§€ ì „ì†¡ ì‹¤íŒ¨:`,o),this.unregisterContentScript(e)}},async isContentScriptActive(t){if(!this.contentScriptTabs.has(t))return!1;try{const r=await Promise.race([chrome.tabs.sendMessage(t,{action:"ping",timestamp:Date.now()}),new Promise((e,o)=>setTimeout(()=>o(new Error("Ping timeout")),2e3))]);return!0}catch(r){return console.warn(`íƒ­ ${t} ì—°ê²° í™•ì¸ ì‹¤íŒ¨:`,r),this.unregisterContentScript(t),!1}},async checkAllContentScripts(){const t=[...this.contentScriptTabs],r=[];for(const e of t)try{const o=await this.isContentScriptActive(e);r.push({tabId:e,active:o})}catch{r.push({tabId:e,active:!1})}return r}},L={isEnabled:!0,apiKey:"",model:"gpt-4o-mini",modelOptions:["gpt-4o-mini","gpt-3.5-turbo","gpt-4"],toneOptions:["Web3 Degen"],selectedTone:"Web3 Degen",useCustomPrompt:!1,customPrompt:""},s={MAX_LOGS:100,async addLog(t,r="info",e){const o=await this.getLogs(),c={timestamp:new Date().toISOString(),message:t,type:r,details:e?JSON.stringify(e):void 0};o.unshift(c),o.length>this.MAX_LOGS&&o.pop(),await g.set("debug_logs",o),console.log(`[${r.toUpperCase()}] ${t}`,e||""),this.notifyLogUpdate()},async getLogs(){const t=await g.get("debug_logs");return Array.isArray(t)?t:[]},async clearLogs(){await g.set("debug_logs",[]),this.notifyLogUpdate()},notifyLogUpdate(){try{chrome.runtime.sendMessage({action:"logUpdated"}).catch(t=>{console.debug("ë¡œê·¸ ì—…ë°ì´íŠ¸ ì•Œë¦¼ ì‹¤íŒ¨ (íŒì—…ì´ ì—´ë ¤ìˆì§€ ì•Šì„ ìˆ˜ ìˆìŒ)")})}catch{console.debug("ë¡œê·¸ ì—…ë°ì´íŠ¸ ì•Œë¦¼ ì‹¤íŒ¨ (íŒì—…ì´ ì—´ë ¤ìˆì§€ ì•Šì„ ìˆ˜ ìˆìŒ)")}}},I={},T={lastContext:null,contextHistory:[],MAX_HISTORY_SIZE:10,saveContext(t,r){var e,o,c,p,u,h,m,n;this.lastContext=t,this.contextHistory.unshift(t),this.contextHistory.length>this.MAX_HISTORY_SIZE&&this.contextHistory.pop();try{g.set("last_context",t),g.set("context_history",this.contextHistory)}catch(l){console.error("ì»¨í…ìŠ¤íŠ¸ ì €ì¥ ì˜¤ë¥˜:",l)}try{const l=((o=(e=t.thread_context)==null?void 0:e.collection_stats)==null?void 0:o.found_tweets)||0,y=((u=(p=(c=t.thread_context)==null?void 0:c.mainTweet)==null?void 0:p.author)==null?void 0:u.username)||"N/A",a=((n=(m=(h=t.thread_context)==null?void 0:h.replyTarget)==null?void 0:m.author)==null?void 0:n.username)||"N/A";s.addLog("ì»¨í…ìŠ¤íŠ¸ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤","success",{tweet_count:l,main_tweet_author:y,reply_target_author:a,timestamp:t.timestamp})}catch(l){console.error("ì»¨í…ìŠ¤íŠ¸ ë¡œê¹… ì˜¤ë¥˜:",l)}},getLastContext(){return this.lastContext},getContextHistory(){return this.contextHistory},async initialize(){try{const t=await g.get("last_context");t&&(this.lastContext=t);const r=await g.get("context_history");Array.isArray(r)&&(this.contextHistory=r)}catch(t){console.error("ì»¨í…ìŠ¤íŠ¸ ì´ˆê¸°í™” ì˜¤ë¥˜:",t)}}};chrome.runtime.onInstalled.addListener(async t=>{const r=t.reason;console.log(`X í—¬í¼ê°€ ${r}ë˜ì—ˆìŠµë‹ˆë‹¤.`),await g.set("settings",L),await s.clearLogs(),await s.addLog(`X í—¬í¼ê°€ ${r}ë˜ì—ˆìŠµë‹ˆë‹¤.`,"info"),await T.initialize(),d.keepAlive()});chrome.runtime.onStartup.addListener(()=>{console.log("X í—¬í¼ê°€ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤."),s.addLog("X í—¬í¼ê°€ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤.","info"),d.keepAlive()});chrome.tabs.onRemoved.addListener(t=>{b.unregisterContentScript(t),delete I[t.toString()]});function i(t,r){try{t(r)}catch(e){console.error("ì‘ë‹µ ì „ì†¡ ì˜¤ë¥˜:",e)}}chrome.runtime.onMessage.addListener((t,r,e)=>{var p,u,h,m;if(t&&t.responseId&&d.hasPendingResponse(t.responseId))return d.executePendingResponse(t.responseId,t.data),!1;const{action:o,data:c}=t;if((p=r.tab)!=null&&p.id&&b.registerContentScript(r.tab.id),o==="ping")return i(e,{pong:!0,timestamp:Date.now(),uptime:Math.floor((Date.now()-d.startTime)/1e3)}),!0;if(o==="getSettings")return g.get("settings").then(n=>{i(e,{settings:n||L})}).catch(n=>{console.error("ì„¤ì • ë¡œë“œ ì˜¤ë¥˜:",n),i(e,{error:"ì„¤ì • ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."})}),!0;if(o==="saveSettings")return g.set("settings",c).then(()=>{s.addLog("ì„¤ì •ì´ ì—…ë°ì´íŠ¸ë˜ì—ˆìŠµë‹ˆë‹¤.","info",c),i(e,{success:!0})}).catch(n=>{console.error("ì„¤ì • ì €ì¥ ì˜¤ë¥˜:",n),i(e,{error:"ì„¤ì • ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."})}),!0;if(o==="addLog"){try{const{message:n,type:l,details:y}=c;s.addLog(n,l,y).then(()=>{i(e,{success:!0})}).catch(a=>{console.error("ë¡œê·¸ ì¶”ê°€ ì˜¤ë¥˜:",a),i(e,{error:"ë¡œê·¸ ì¶”ê°€ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."})})}catch(n){console.error("ë¡œê·¸ ë°ì´í„° ì²˜ë¦¬ ì˜¤ë¥˜:",n),i(e,{error:"ë¡œê·¸ ë°ì´í„° ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."})}return!0}if(o==="getLogs")return s.getLogs().then(n=>{i(e,{logs:n})}).catch(n=>{console.error("ë¡œê·¸ ì¡°íšŒ ì˜¤ë¥˜:",n),i(e,{error:"ë¡œê·¸ ì¡°íšŒ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."})}),!0;if(o==="clearLogs")return s.clearLogs().then(()=>{i(e,{success:!0})}).catch(n=>{console.error("ë¡œê·¸ ì´ˆê¸°í™” ì˜¤ë¥˜:",n),i(e,{error:"ë¡œê·¸ ì´ˆê¸°í™” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."})}),!0;if(o==="getLastContext"){try{const n=T.getLastContext();i(e,{context:n})}catch(n){console.error("ì»¨í…ìŠ¤íŠ¸ ì¡°íšŒ ì˜¤ë¥˜:",n),i(e,{error:"ì»¨í…ìŠ¤íŠ¸ ì¡°íšŒ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."})}return!0}if(o==="getContextHistory"){try{const n=T.getContextHistory();i(e,{history:n})}catch(n){console.error("ì»¨í…ìŠ¤íŠ¸ íˆìŠ¤í† ë¦¬ ì¡°íšŒ ì˜¤ë¥˜:",n),i(e,{error:"ì»¨í…ìŠ¤íŠ¸ íˆìŠ¤í† ë¦¬ ì¡°íšŒ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."})}return!0}if(o==="generateResponse"){try{s.addLog("AI ì‘ë‹µ ìƒì„± ìš”ì²­ ìˆ˜ì‹ ","info",c);const n=(u=r.tab)==null?void 0:u.id;if(!n)return s.addLog("íƒ­ IDë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.","error"),i(e,{error:"íƒ­ IDë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."}),!0;const l={user_input:c.tweetText,thread_context:c.threadContext,settings:{tone:c.tone,model:c.model},timestamp:new Date().toISOString()};if(T.saveContext(l,n),c.threadContext){const a=c.threadContext;s.addLog("íŠ¸ìœ— ìŠ¤ë ˆë“œ êµ¬ì¡° ë¶„ì„","info",{structure:a.threadStructure,tweetCount:(((h=a.intermediateReplies)==null?void 0:h.length)||0)+(a.mainTweet?1:0)+(a.replyTarget?1:0)}),a.mainTweet&&s.addLog("ë©”ì¸ íŠ¸ìœ— ê°ì§€ë¨","info",{author:a.mainTweet.author.username,text:a.mainTweet.text.substring(0,100)+(a.mainTweet.text.length>100?"...":"")}),a.replyTarget&&s.addLog("ë‹µì¥ ëŒ€ìƒ íŠ¸ìœ— ê°ì§€ë¨","info",{author:a.replyTarget.author.username,text:a.replyTarget.text.substring(0,100)+(a.replyTarget.text.length>100?"...":"")}),a.intermediateReplies&&a.intermediateReplies.length>0&&s.addLog(`${a.intermediateReplies.length}ê°œì˜ ì¤‘ê°„ ë‹µê¸€ ê°ì§€ë¨`,"info")}n&&(I[n.toString()]=c),(async()=>{try{const a=await g.get("settings")||L,v=(a==null?void 0:a.apiKey)||"",A=(a==null?void 0:a.model)||"gpt-3.5-turbo",x=P(c.threadContext);s.addLog("Web3 Degen í”„ë¡¬í”„íŠ¸ ìƒì„± ì™„ë£Œ","info",{promptLength:x.userPrompt.length}),setTimeout(async()=>{try{let f=[];try{s.addLog("OpenAI API í˜¸ì¶œ ì‹œì‘","info");const w=await O(x,v,A);f=$(w),s.addLog("OpenAI ì‘ë‹µ íŒŒì‹± ì™„ë£Œ","success",{response_count:f.length})}catch(w){s.addLog("ì‘ë‹µ ìƒì„± ì˜¤ë¥˜","error",w),f=[{text:"ì‘ë‹µ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•˜ê±°ë‚˜ API í‚¤ ì„¤ì •ì„ í™•ì¸í•´ì£¼ì„¸ìš”.",type:"error"}]}b.isContentScriptActive(n).then(w=>{w?i(e,{responses:f}):(s.addLog("ì½˜í…ì¸  ìŠ¤í¬ë¦½íŠ¸ ì—°ê²°ì´ ëŠì–´ì¡ŒìŠµë‹ˆë‹¤.","error"),i(e,{error:"ì½˜í…ì¸  ìŠ¤í¬ë¦½íŠ¸ ì—°ê²°ì´ ëŠì–´ì¡ŒìŠµë‹ˆë‹¤."}))}).catch(()=>{i(e,{responses:f})})}catch(f){s.addLog("ì‘ë‹µ ìƒì„± ì¤‘ ì˜¤ë¥˜ ë°œìƒ","error",f),i(e,{error:"ì‘ë‹µ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."})}},500)}catch(a){s.addLog("ì„¤ì • ë° í”„ë¡¬í”„íŠ¸ ìƒì„± ì¤‘ ì˜¤ë¥˜","error",a),i(e,{error:"ì‘ë‹µ ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."})}})()}catch(n){s.addLog("ì‘ë‹µ ìƒì„± ìš”ì²­ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜","error",n),i(e,{error:"ì‘ë‹µ ìƒì„± ìš”ì²­ ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."})}return!0}if(o==="copyContext"){const n=(m=t.tabId)==null?void 0:m.toString();if(n&&I[n]){const l=JSON.stringify(I[n],null,2);_(l).then(()=>{s.addLog("ì»¨í…ìŠ¤íŠ¸ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤.","success"),i(e,{success:!0,message:"ì»¨í…ìŠ¤íŠ¸ê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤."})}).catch(y=>{s.addLog("í´ë¦½ë³´ë“œ ë³µì‚¬ ì‹¤íŒ¨","error",y),i(e,{error:"í´ë¦½ë³´ë“œ ë³µì‚¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤."})})}else s.addLog("ì‚¬ìš© ê°€ëŠ¥í•œ ì»¨í…ìŠ¤íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤.","error"),i(e,{success:!1,message:"ì‚¬ìš© ê°€ëŠ¥í•œ ì»¨í…ìŠ¤íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤."});return!0}return i(e,{error:`ì§€ì›ë˜ì§€ ì•ŠëŠ” ì•¡ì…˜: ${o}`}),!0});async function _(t){try{const e=(await chrome.tabs.create({url:"about:blank",active:!1})).id;if(!e)throw new Error("íƒ­ IDë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.");await chrome.scripting.executeScript({target:{tabId:e},func:o=>{navigator.clipboard.writeText(o).then(()=>console.log("í´ë¦½ë³´ë“œì— ë³µì‚¬ ì„±ê³µ")).catch(c=>console.error("í´ë¦½ë³´ë“œ ë³µì‚¬ ì‹¤íŒ¨:",c))},args:[t]}),await new Promise(o=>setTimeout(o,500)),await chrome.tabs.remove(e)}catch(r){throw console.error("í´ë¦½ë³´ë“œ ë³µì‚¬ í•¨ìˆ˜ ì˜¤ë¥˜:",r),r}}chrome.runtime.onSuspend.addListener(()=>{console.log("ì„œë¹„ìŠ¤ ì›Œì»¤ê°€ ì¼ì‹œ ì¤‘ë‹¨ë©ë‹ˆë‹¤."),s.addLog("ì„œë¹„ìŠ¤ ì›Œì»¤ê°€ ì¼ì‹œ ì¤‘ë‹¨ë©ë‹ˆë‹¤.","warn"),d.cleanup()});chrome.runtime.onSuspendCanceled.addListener(()=>{console.log("ì„œë¹„ìŠ¤ ì›Œì»¤ ì¤‘ë‹¨ì´ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤."),s.addLog("ì„œë¹„ìŠ¤ ì›Œì»¤ ì¤‘ë‹¨ì´ ì·¨ì†Œë˜ì—ˆìŠµë‹ˆë‹¤.","info"),d.keepAlive()});d.keepAlive();function $(t){const r=[],e=t.split(`

`);try{for(const o of e)o.trim()!==""&&(o.startsWith("1/")?r.push({text:o.substring(2).trim(),type:"greeting"}):o.startsWith("2/")?r.push({text:o.substring(2).trim(),type:"agreement"}):o.startsWith("3/")?r.push({text:o.substring(2).trim(),type:"joke"}):(console.warn("Unexpected response format:",o),r.push({text:o.trim(),type:"default"})));return r.length===0&&console.error("ì‘ë‹µ íŒŒì‹± ì˜¤ë¥˜: ì˜¬ë°”ë¥¸ í˜•ì‹ì˜ ì‘ë‹µì´ ì—†ìŠµë‹ˆë‹¤",t),r}catch(o){return console.error("ì‘ë‹µ íŒŒì‹± ì¤‘ ì˜¤ë¥˜ ë°œìƒ:",o),[{text:t,type:"error"}]}}async function O(t,r,e="gpt-3.5-turbo"){var o,c,p;try{if(!r)throw new Error("OpenAI API í‚¤ê°€ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.");const u={model:e,messages:[{role:"system",content:t.systemPrompt},{role:"user",content:t.userPrompt}],temperature:.7,max_tokens:1e3};s.addLog("OpenAI API ìš”ì²­","info",{model:e,prompt_length:t.userPrompt.length,temperature:.7,max_tokens:1e3});const h=await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r}`},body:JSON.stringify(u)});if(!h.ok){const l=await h.json();throw new Error(`OpenAI API ì˜¤ë¥˜: ${((o=l.error)==null?void 0:o.message)||"ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜"}`)}const m=await h.json(),n=((p=(c=m.choices[0])==null?void 0:c.message)==null?void 0:p.content)||"";return s.addLog("OpenAI API ì‘ë‹µ ìˆ˜ì‹ ","success",{response_length:n.length,usage:m.usage}),n}catch(u){return s.addLog("OpenAI API ì˜¤ë¥˜","error",u.message),`1/ API ì˜¤ë¥˜ë¡œ ì‘ë‹µì„ ìƒì„±í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì„¤ì •ì—ì„œ API í‚¤ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”!

2/ "${u.message}"

3/ ê°œë°œìì—ê²Œ ì´ ì˜¤ë¥˜ ë©”ì‹œì§€ë¥¼ ì „ë‹¬í•´ì£¼ì„¸ìš”.`}}
